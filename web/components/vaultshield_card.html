<section
  class="mt-10 max-w-6xl mx-auto bg-slate-900/80 border border-slate-800 rounded-3xl p-8 shadow-xl backdrop-blur-sm fade-in"
>
  <div class="flex items-start justify-between gap-6 mb-8">
    <div>
      <h3 class="text-2xl font-semibold text-slate-50">
        VaultShield â€” Threat Narratives
      </h3>
      <p class="mt-1 text-sm text-slate-300 max-w-xl">
        Sequence-based anomaly detection for identity attacks (Password Spray, Impossible Travel).
      </p>
    </div>

    <div
      class="inline-flex items-center rounded-2xl border border-rose-500/30 bg-rose-500/10 px-4 py-2 text-xs font-medium text-rose-300 whitespace-nowrap"
    >
      <span class="mr-2 h-2 w-2 rounded-full bg-rose-500 animate-pulse"></span>
      Markov Chain Active
    </div>
  </div>

  <div data-tab-group="vaultshield" class="flex flex-col min-h-[460px]">
    
    <div class="flex-none flex flex-wrap gap-6 border-b border-slate-800 text-sm font-medium text-slate-400 mb-6">
      <button
        type="button"
        data-tab-target="monitor"
        class="pb-3 border-b-2 border-rose-500 text-slate-50 transition-colors"
      >
        Threat Monitor
      </button>
      <button
        type="button"
        data-tab-target="forensics"
        class="pb-3 border-b-2 border-transparent hover:text-slate-200 hover:border-slate-600 transition-colors"
      >
        Session Forensics
      </button>
      <button
        type="button"
        data-tab-target="metrics"
        class="pb-3 border-b-2 border-transparent hover:text-slate-200 hover:border-slate-600 transition-colors"
      >
        Detection Metrics
      </button>
    </div>

    <div data-tab-content="monitor" class="flex-1 flex flex-col min-h-0 animate-fade-in">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div class="rounded-2xl border border-slate-800 bg-slate-950/50 p-5">
            <p class="text-slate-400 text-[0.65rem] uppercase font-bold tracking-wider mb-2">Current Threat Level</p>
            <div class="flex items-baseline gap-2">
                <span id="vs-stat-threat-level" class="text-3xl font-mono font-bold text-rose-500">HIGH</span>
                <span class="text-xs text-rose-400/80 font-medium animate-pulse">Active Attacks</span>
            </div>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-950/50 p-5">
            <p class="text-slate-400 text-[0.65rem] uppercase font-bold tracking-wider mb-2">Sessions Analyzed</p>
            <span id="vs-stat-sessions" class="text-3xl font-mono font-bold text-slate-200">--</span>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-950/50 p-5">
            <p class="text-slate-400 text-[0.65rem] uppercase font-bold tracking-wider mb-2">Attacks Blocked (7d)</p>
            <span id="vs-stat-blocked" class="text-3xl font-mono font-bold text-emerald-400">--</span>
        </div>
      </div>

      <div class="flex-1 relative rounded-2xl border border-slate-800 bg-slate-950/50 p-4 min-h-[300px]">
        <h4 class="text-xs font-bold text-slate-500 mb-4 uppercase tracking-wider">Top Detected Attack Vectors</h4>
        <div class="absolute inset-0 top-10 p-4">
            <canvas data-vs-attack-chart></canvas>
        </div>
      </div>
    </div>

    <div data-tab-content="forensics" class="hidden flex-1 flex flex-col animate-fade-in">
        <div class="flex items-center justify-between mb-4">
            <h4 class="text-sm text-slate-300">Analysis of Most Anomalous Session</h4>
            <div id="vs-session-header" class="text-xs font-mono text-slate-500">ID: --</div>
        </div>

        <div class="w-full overflow-x-auto pb-4 mb-6 scrollbar-thin scrollbar-thumb-slate-700">
            <div id="vs-timeline-container" class="flex items-center min-w-max px-4 py-8 space-x-2">
                </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="rounded-xl border border-rose-500/20 bg-rose-500/5 p-5">
                <p class="text-rose-400 text-xs font-bold uppercase mb-2">Anomaly Detected</p>
                <p id="vs-explanation-text" class="text-slate-200 text-sm leading-relaxed">
                    Loading analysis...
                </p>
            </div>
            <div class="rounded-xl border border-slate-800 bg-slate-950/50 p-5">
                <div class="flex justify-between items-center mb-2">
                    <p class="text-slate-400 text-xs font-bold uppercase">Sequence Score</p>
                    <span id="vs-score-val" class="text-xl font-mono font-bold text-rose-500">--</span>
                </div>
                <div class="w-full bg-slate-800 rounded-full h-1.5 mt-2">
                    <div id="vs-score-bar" class="bg-gradient-to-r from-emerald-500 to-rose-500 h-1.5 rounded-full" style="width: 0%"></div>
                </div>
                <p class="text-[0.65rem] text-slate-500 mt-2">
                    Higher scores indicate rare or impossible event transitions based on the Markov model.
                </p>
            </div>
        </div>
    </div>

    <div data-tab-content="metrics" class="hidden flex-1 animate-fade-in">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="rounded-2xl border border-slate-800 bg-slate-950/50 p-6 h-[300px] relative">
                <h4 class="text-xs font-bold text-slate-500 mb-4 uppercase">Score Distribution (Normal vs Attack)</h4>
                <div class="absolute inset-0 top-10 p-4">
                    <canvas data-vs-dist-chart></canvas>
                </div>
            </div>
            
            <div class="space-y-4">
                <div class="p-4 rounded-xl border border-slate-800 bg-slate-900/50">
                    <div class="flex justify-between mb-1">
                        <span class="text-sm text-slate-300">False Positive Rate</span>
                        <span class="text-sm font-mono text-emerald-400 font-bold">0.4%</span>
                    </div>
                    <div class="w-full bg-slate-800 h-1 rounded-full"><div class="w-[0.4%] bg-emerald-400 h-1 rounded-full"></div></div>
                </div>

                <div class="p-4 rounded-xl border border-slate-800 bg-slate-900/50">
                    <div class="flex justify-between mb-1">
                        <span class="text-sm text-slate-300">Detection Rate (Recall)</span>
                        <span class="text-sm font-mono text-sky-400 font-bold">98.2%</span>
                    </div>
                    <div class="w-full bg-slate-800 h-1 rounded-full"><div class="w-[98.2%] bg-sky-400 h-1 rounded-full"></div></div>
                </div>

                <div class="p-4 rounded-xl border border-slate-800 bg-slate-900/50">
                    <div class="flex justify-between mb-1">
                        <span class="text-sm text-slate-300">Mean Time to Detect</span>
                        <span class="text-sm font-mono text-slate-200 font-bold">120ms</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

  </div>
</section>